<h1 class="task_list">My Lists</h1>
<%= link_to "+ Add Task List", new_task_list_path, class: "add" %>
<%= link_to "View Assigned Tasks", user_tasks_path(session[:user_id]), class: "add" %>
<%= form_tag "/search", method: :get, class: "search" do %>
  <%= text_field_tag :q %>
  <%= submit_tag "Search Tasks" %>
<% end %>
<% if flash[:notice] %>
  <div class="flash">
    <%= flash[:notice] %>
  </div>
<% end %>
<% @task_lists.each do |task_list| %>
  <section>
    <h1><%= link_to task_list[:task_list].name, task_list_path(task_list[:task_list].id), class: "task_list" %></h1>

    <div class="list_options">
      <%= link_to "Completed", task_list_completed_path(task_list[:task_list].id) %>
      <%= form_for task_list[:task_list], method: :delete do |f| %>
        <%= f.submit "Delete" %>
      <% end %>
      <%= link_to "Edit", edit_task_list_path(task_list[:task_list].id) %>
      <%= link_to "Add Task", new_task_list_task_path(task_list[:task_list].id) %>
    </div>
    <ul>
      <% if task_list[:tasks].any? %>
        <% task_list[:tasks].each do |task| %>
          <li>
            <div class="task">
              <div class="task_name">
                <%= task.description + " (" + (task.date.mjd - Date.today.mjd).to_s + " days)" %> -
                <b><%= task.user %></b>
              </div>
              <%= form_for [task_list[:task_list], task], method: :delete do |f| %>
                <%= f.submit "Delete", class: "delete" %>
              <% end %>
              <%= form_for [task_list[:task_list], task], url: task_complete_path(task_list[:task_list].id, task.id) do |f| %>
                <%= f.submit "Complete", class: "delete" %>
              <% end %>
            </div>
          </li>
        <% end %>
      <% else %>
        <li>
          <div class="task_blank">
            <span>Nothing here to see!</span>
          </div>
        </li>
      <% end %>
    </ul>
  </section>
<% end %>